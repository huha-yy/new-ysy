# 户外徒步活动管理系统 - 后端开发提示词文档

> 使用说明：按阶段顺序使用以下提示词，每个提示词复制后发送给AI即可。
> 注意：部分提示词需要补充具体的SQL或设计内容（用 `[待补充]` 标记）。

---

## 阶段一：项目初始化

### 1.1 创建SpringBoot项目

```
我正在开发一个"基于SpringBoot的户外徒步活动管理系统"。

请帮我在ysy文件夹中创建SpringBoot项目的基础结构。

技术栈要求（来自系统架构设计文档）：
- SpringBoot 3.2.0
- JDK 17
- MyBatis-Plus 3.5.5
- Spring Security + JWT (jjwt 0.12.3)
- MySQL 8.0
- SpringDoc OpenAPI 2.3.0 + Knife4j 4.3.0

【重要】版本兼容说明：
以上版本组合已验证兼容，请严格按照这些版本生成pom.xml，不要随意更改版本号。

项目信息：
- GroupId: com.hiking
- ArtifactId: hiking-backend
- 项目名称: hiking-backend

请生成：
1. pom.xml（包含所有依赖，使用上述指定版本）
2. application.yml（开发环境配置模板）
3. 启动类 HikingApplication.java

pom.xml要求：
- 使用spring-boot-starter-parent作为父项目
- SpringBoot管理的依赖不写版本号
- 第三方依赖使用properties统一管理版本号
- MyBatis-Plus使用mybatis-plus-spring-boot3-starter（注意是boot3版本）

数据库连接信息：
- 数据库名：hiking_system
- 端口：3306
- 用户名：root
- 密码：123666888
```

---

### 1.2 创建包结构

```
请根据系统架构设计，创建后端项目的包结构。

包结构设计（来自系统架构设计文档）：
com.hiking
├── config/                     # 配置类
├── common/                     # 公共模块
│   ├── result/                 # 统一响应
│   ├── exception/              # 异常处理
│   ├── constant/               # 常量定义
│   └── utils/                  # 工具类
├── security/                   # 安全模块
└── module/                     # 业务模块
    ├── user/                   # 用户模块
    │   ├── controller/
    │   ├── service/
    │   ├── mapper/
    │   ├── entity/
    │   ├── dto/
    │   └── vo/
    ├── activity/               # 活动模块
    ├── registration/           # 报名模块
    ├── route/                  # 路线模块
    ├── checkin/                # 签到模块
    ├── review/                 # 评价模块
    ├── message/                # 消息模块
    └── system/                 # 系统模块

请为每个包创建 package-info.java 或示例类占位。
```

---

## 阶段二：公共模块开发

### 2.1 统一响应封装

```
请实现统一响应封装类。

要求（来自系统架构设计文档-接口规范）：
1. 响应格式：
{
    "code": 200,
    "message": "操作成功",
    "data": {},
    "timestamp": 1703318400000
}

2. 状态码定义：
- 200: 成功
- 400: 请求参数错误
- 401: 未认证
- 403: 无权限
- 404: 资源不存在
- 500: 服务器内部错误
- 1001-1999: 用户相关错误
- 2001-2999: 活动相关错误
- 3001-3999: 报名相关错误

请生成：
1. Result<T> 统一响应类
2. ResultCode 状态码枚举
3. 常用静态方法：success(), error(), error(code, message)
```

---

### 2.2 全局异常处理

```
请实现全局异常处理。

要求：
1. 自定义业务异常 BusinessException（包含code和message）
2. 全局异常处理器 GlobalExceptionHandler，捕获：
   - BusinessException → 返回对应错误码
   - MethodArgumentNotValidException → 返回400和校验错误信息
   - Exception → 返回500
3. 统一使用Result返回

请生成：
1. BusinessException.java
2. GlobalExceptionHandler.java
```

---

### 2.3 MyBatis-Plus配置

```
请配置MyBatis-Plus。

要求：
1. 分页插件配置
2. 自动填充配置（用于公共字段）：
   - create_time: 插入时自动填充当前时间
   - update_time: 插入和更新时自动填充当前时间
   - create_by: 插入时自动填充当前用户ID
   - update_by: 更新时自动填充当前用户ID
3. 逻辑删除配置（如果需要）

请生成：
1. MyBatisPlusConfig.java
2. MyMetaObjectHandler.java（自动填充处理器）
```

---

### 2.4 JWT工具类

```
请实现JWT工具类。

要求：
1. 生成Token（包含用户ID、用户名、角色）
2. 解析Token获取用户信息
3. 验证Token是否有效
4. Token有效期：24小时
5. 密钥从配置文件读取

配置项：
jwt:
  secret: your-secret-key-at-least-32-characters
  expiration: 86400000

请生成：
1. JwtUtils.java
2. 在application.yml中添加jwt配置
```

---

### 2.5 Spring Security配置

```
请配置Spring Security + JWT认证。

要求：
1. 放行接口：
   - /api/auth/** （登录注册）
   - /api/activities（活动列表，GET）
   - /api/activities/{id}（活动详情，GET）
   - /doc.html, /swagger-ui/**, /v3/api-docs/**（Swagger）
2. 其他接口需要JWT认证
3. 禁用CSRF（前后端分离）
4. 配置CORS跨域
5. 密码加密使用BCryptPasswordEncoder

请生成：
1. SecurityConfig.java
2. JwtAuthenticationFilter.java（JWT过滤器）
3. UserDetailsServiceImpl.java（用户详情服务，先写框架）
4. SecurityUtils.java（获取当前登录用户的工具类）
```

---

### 2.6 Swagger配置

```
请配置SpringDoc OpenAPI（Swagger）。

要求：
1. 文档标题：户外徒步活动管理系统 API
2. 版本：1.0
3. 支持JWT认证（在Swagger中添加Authorization头）
4. 使用Knife4j美化界面

请生成：
1. SwaggerConfig.java（或OpenApiConfig.java）
```

---

### 2.7 跨域配置

```
请配置CORS跨域。

要求：
1. 允许来源：http://localhost:5173（Vite开发服务器）
2. 允许所有方法：GET, POST, PUT, DELETE, OPTIONS
3. 允许所有头
4. 允许携带Cookie
5. 预检请求缓存时间：3600秒

请生成：
1. CorsConfig.java
```

---

### 2.8 地理距离计算工具

```
请实现地理距离计算工具类（用于签到功能）。

要求（来自功能模块设计文档-签到技术说明）：
1. 使用Haversine公式计算两点间距离
2. 输入：两个点的经纬度（lat1, lng1, lat2, lng2）
3. 输出：距离（米）
4. 地球半径常量：6371000米

请生成：
1. GeoUtils.java
```

---

## 阶段三：Entity实体类生成

### 3.1 用户相关Entity

```
请根据以下SQL表结构，生成对应的Entity实体类。

表结构（来自hiking_system.sql）：
DROP TABLE IF EXISTS `user`;
CREATE TABLE `user` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    `username` VARCHAR(32) NOT NULL COMMENT '用户名（唯一）',
    `password` VARCHAR(64) NOT NULL COMMENT '密码（BCrypt加密）',
    `phone` VARCHAR(16) DEFAULT NULL COMMENT '手机号（唯一）',
    `email` VARCHAR(64) DEFAULT NULL COMMENT '邮箱（唯一）',
    `nickname` VARCHAR(32) DEFAULT NULL COMMENT '昵称',
    `avatar` VARCHAR(256) DEFAULT NULL COMMENT '头像URL',
    `role` TINYINT NOT NULL DEFAULT 0 COMMENT '角色：0普通用户 1组织者 2管理员',
    `status` TINYINT NOT NULL DEFAULT 1 COMMENT '状态：0禁用 1正常',
    `last_login_time` DATETIME DEFAULT NULL COMMENT '最后登录时间',
    `create_by` BIGINT DEFAULT NULL COMMENT '创建者ID',
    `update_by` BIGINT DEFAULT NULL COMMENT '更新者ID',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    PRIMARY KEY (`id`),
    UNIQUE INDEX `idx_username` (`username`),
    UNIQUE INDEX `idx_phone` (`phone`),
    UNIQUE INDEX `idx_email` (`email`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户表';

DROP TABLE IF EXISTS `user_profile`;
CREATE TABLE `user_profile` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    `user_id` BIGINT NOT NULL COMMENT '用户ID（唯一）',
    `real_name` VARCHAR(32) DEFAULT NULL COMMENT '真实姓名',
    `gender` TINYINT DEFAULT NULL COMMENT '性别：0未知 1男 2女',
    `birth_date` DATE DEFAULT NULL COMMENT '出生日期',
    `experience_level` TINYINT NOT NULL DEFAULT 0 COMMENT '徒步经验：0新手 1初级 2中级 3高级 4专业',
    `health_status` VARCHAR(256) DEFAULT NULL COMMENT '健康状况描述',
    `medical_history` VARCHAR(512) DEFAULT NULL COMMENT '病史/过敏史',
    `emergency_contact` VARCHAR(32) DEFAULT NULL COMMENT '紧急联系人姓名',
    `emergency_phone` VARCHAR(16) DEFAULT NULL COMMENT '紧急联系人电话',
    `equipment_list` VARCHAR(512) DEFAULT NULL COMMENT '常用装备清单',
    `preference_intensity` TINYINT DEFAULT NULL COMMENT '偏好强度：1低 2中 3高',
    `preference_distance` TINYINT DEFAULT NULL COMMENT '偏好里程：1短(<10km) 2中(10-20km) 3长(>20km)',
    `preference_region` VARCHAR(128) DEFAULT NULL COMMENT '偏好地区（多个逗号分隔）',
    `bio` VARCHAR(256) DEFAULT NULL COMMENT '个人简介',
    `create_by` BIGINT DEFAULT NULL COMMENT '创建者ID',
    `update_by` BIGINT DEFAULT NULL COMMENT '更新者ID',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    PRIMARY KEY (`id`),
    UNIQUE INDEX `idx_user_id` (`user_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户档案表';

要求：
1. 使用Lombok注解：@Data, @TableName, @Builder, @NoArgsConstructor, @AllArgsConstructor
2. 使用MyBatis-Plus注解：@TableId, @TableField
3. 主键策略：IdType.AUTO
4. 公共字段使用@TableField(fill = FieldFill.INSERT)等
5. 枚举字段添加注释说明取值含义
6. 放在 com.hiking.module.user.entity 包下

请生成：
1. User.java
2. UserProfile.java
```

---

### 3.2 活动相关Entity

```
请根据以下SQL表结构，生成Entity实体类。

表结构（来自hiking_system.sql）：
DROP TABLE IF EXISTS `activity`;
CREATE TABLE `activity` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    `title` VARCHAR(128) NOT NULL COMMENT '活动标题',
    `cover_image` VARCHAR(256) DEFAULT NULL COMMENT '封面图片URL',
    `description` TEXT DEFAULT NULL COMMENT '活动详细描述',
    `organizer_id` BIGINT NOT NULL COMMENT '组织者用户ID',
    `route_id` BIGINT DEFAULT NULL COMMENT '关联路线ID',
    `activity_date` DATE NOT NULL COMMENT '活动日期',
    `start_time` TIME NOT NULL COMMENT '开始时间',
    `end_time` TIME DEFAULT NULL COMMENT '预计结束时间',
    `duration_hours` DECIMAL(4,1) DEFAULT NULL COMMENT '预计时长（小时）',
    `max_participants` INT NOT NULL DEFAULT 20 COMMENT '人数上限',
    `current_participants` INT NOT NULL DEFAULT 0 COMMENT '当前报名人数',
    `registration_deadline` DATETIME NOT NULL COMMENT '报名截止时间',
    `difficulty_level` TINYINT NOT NULL DEFAULT 1 COMMENT '难度：1休闲 2简单 3中等 4困难 5极限',
    `fee` DECIMAL(10,2) DEFAULT 0.00 COMMENT '费用（元）',
    `fee_description` VARCHAR(256) DEFAULT NULL COMMENT '费用说明',
    `equipment_requirement` VARCHAR(512) DEFAULT NULL COMMENT '装备要求',
    `fitness_requirement` VARCHAR(256) DEFAULT NULL COMMENT '体能要求',
    `age_min` INT DEFAULT NULL COMMENT '最小年龄限制',
    `age_max` INT DEFAULT NULL COMMENT '最大年龄限制',
    `experience_requirement` TINYINT DEFAULT NULL COMMENT '经验要求：0不限 1初级以上 2中级以上 3高级以上',
    `status` TINYINT NOT NULL DEFAULT 0 COMMENT '状态：0草稿 1待审核 2已发布 3进行中 4已结束 5已取消 6已驳回',
    `reject_reason` VARCHAR(256) DEFAULT NULL COMMENT '驳回原因',
    `audit_by` BIGINT DEFAULT NULL COMMENT '审核人ID',
    `audit_time` DATETIME DEFAULT NULL COMMENT '审核时间',
    `view_count` INT NOT NULL DEFAULT 0 COMMENT '浏览次数',
    `create_by` BIGINT DEFAULT NULL COMMENT '创建者ID',
    `update_by` BIGINT DEFAULT NULL COMMENT '更新者ID',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    PRIMARY KEY (`id`),
    INDEX `idx_organizer_id` (`organizer_id`),
    INDEX `idx_status` (`status`),
    INDEX `idx_activity_date` (`activity_date`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='活动表';

要求同上，放在 com.hiking.module.activity.entity 包下。

请生成：
1. Activity.java
```

---

### 3.3 报名相关Entity

```
请根据以下SQL表结构，生成Entity实体类。

表结构：
DROP TABLE IF EXISTS `registration`;
CREATE TABLE `registration` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    `user_id` BIGINT NOT NULL COMMENT '用户ID',
    `activity_id` BIGINT NOT NULL COMMENT '活动ID',
    `status` TINYINT NOT NULL DEFAULT 0 COMMENT '状态：0待审核 1已通过 2已拒绝 3候补中 4已取消 5已缺席',
    `reject_reason` VARCHAR(256) DEFAULT NULL COMMENT '拒绝原因',
    `queue_number` INT DEFAULT NULL COMMENT '候补序号',
    `remark` VARCHAR(256) DEFAULT NULL COMMENT '报名备注',
    `audit_by` BIGINT DEFAULT NULL COMMENT '审核人ID',
    `audit_time` DATETIME DEFAULT NULL COMMENT '审核时间',
    `cancel_time` DATETIME DEFAULT NULL COMMENT '取消时间',
    `cancel_reason` VARCHAR(256) DEFAULT NULL COMMENT '取消原因',
    `create_by` BIGINT DEFAULT NULL COMMENT '创建者ID',
    `update_by` BIGINT DEFAULT NULL COMMENT '更新者ID',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    PRIMARY KEY (`id`),
    UNIQUE INDEX `idx_user_activity` (`user_id`, `activity_id`),
    INDEX `idx_activity_id` (`activity_id`),
    INDEX `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='报名表';

DROP TABLE IF EXISTS `gathering_plan`;
CREATE TABLE `gathering_plan` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    `activity_id` BIGINT NOT NULL COMMENT '活动ID（唯一）',
    `gathering_time` DATETIME NOT NULL COMMENT '集合时间',
    `gathering_address` VARCHAR(256) NOT NULL COMMENT '集合地点详细地址',
    `gathering_latitude` DECIMAL(10,7) DEFAULT NULL COMMENT '集合点纬度',
    `gathering_longitude` DECIMAL(10,7) DEFAULT NULL COMMENT '集合点经度',
    `transport_guide` VARCHAR(512) DEFAULT NULL COMMENT '交通指引',
    `items_to_bring` VARCHAR(512) DEFAULT NULL COMMENT '携带物品清单',
    `notice` TEXT DEFAULT NULL COMMENT '注意事项',
    `organizer_phone` VARCHAR(16) DEFAULT NULL COMMENT '组织者联系电话',
    `is_published` TINYINT NOT NULL DEFAULT 0 COMMENT '是否已发布：0否 1是',
    `publish_time` DATETIME DEFAULT NULL COMMENT '发布时间',
    `create_by` BIGINT DEFAULT NULL COMMENT '创建者ID',
    `update_by` BIGINT DEFAULT NULL COMMENT '更新者ID',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    PRIMARY KEY (`id`),
    UNIQUE INDEX `idx_activity_id` (`activity_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='集合方案表';

要求同上。

请生成：
1. Registration.java（放在registration模块）
2. GatheringPlan.java（放在activity模块或单独模块）
```

---

### 3.4 路线相关Entity

```
请根据以下SQL表结构，生成Entity实体类。

表结构：
DROP TABLE IF EXISTS `route`;
CREATE TABLE `route` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    `name` VARCHAR(128) NOT NULL COMMENT '路线名称',
    `description` TEXT DEFAULT NULL COMMENT '路线描述',
    `creator_id` BIGINT NOT NULL COMMENT '创建者用户ID',
    `difficulty_level` TINYINT NOT NULL DEFAULT 1 COMMENT '难度：1休闲 2简单 3中等 4困难 5极限',
    `total_distance` DECIMAL(6,2) DEFAULT NULL COMMENT '总里程（公里）',
    `elevation_gain` INT DEFAULT NULL COMMENT '累计爬升（米）',
    `elevation_loss` INT DEFAULT NULL COMMENT '累计下降（米）',
    `max_elevation` INT DEFAULT NULL COMMENT '最高海拔（米）',
    `min_elevation` INT DEFAULT NULL COMMENT '最低海拔（米）',
    `estimated_hours` DECIMAL(4,1) DEFAULT NULL COMMENT '预计用时（小时）',
    `start_point_name` VARCHAR(64) DEFAULT NULL COMMENT '起点名称',
    `start_latitude` DECIMAL(10,7) DEFAULT NULL COMMENT '起点纬度',
    `start_longitude` DECIMAL(10,7) DEFAULT NULL COMMENT '起点经度',
    `end_point_name` VARCHAR(64) DEFAULT NULL COMMENT '终点名称',
    `end_latitude` DECIMAL(10,7) DEFAULT NULL COMMENT '终点纬度',
    `end_longitude` DECIMAL(10,7) DEFAULT NULL COMMENT '终点经度',
    `region` VARCHAR(64) DEFAULT NULL COMMENT '所属地区',
    `is_public` TINYINT NOT NULL DEFAULT 1 COMMENT '是否公开：0否 1是',
    `use_count` INT NOT NULL DEFAULT 0 COMMENT '被使用次数',
    `status` TINYINT NOT NULL DEFAULT 1 COMMENT '状态：0禁用 1正常',
    `create_by` BIGINT DEFAULT NULL COMMENT '创建者ID',
    `update_by` BIGINT DEFAULT NULL COMMENT '更新者ID',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    PRIMARY KEY (`id`),
    INDEX `idx_creator_id` (`creator_id`),
    INDEX `idx_difficulty_level` (`difficulty_level`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='路线表';

DROP TABLE IF EXISTS `route_point`;
CREATE TABLE `route_point` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    `route_id` BIGINT NOT NULL COMMENT '路线ID',
    `point_type` TINYINT NOT NULL DEFAULT 1 COMMENT '点位类型：1途经点 2风险点 3休息点 4补给点',
    `name` VARCHAR(64) NOT NULL COMMENT '点位名称',
    `description` VARCHAR(256) DEFAULT NULL COMMENT '点位描述',
    `latitude` DECIMAL(10,7) NOT NULL COMMENT '纬度',
    `longitude` DECIMAL(10,7) NOT NULL COMMENT '经度',
    `elevation` INT DEFAULT NULL COMMENT '海拔（米）',
    `sequence` INT NOT NULL DEFAULT 0 COMMENT '顺序号',
    `risk_level` TINYINT DEFAULT NULL COMMENT '风险等级：1低 2中 3高（仅风险点）',
    `risk_tip` VARCHAR(256) DEFAULT NULL COMMENT '风险提示（仅风险点）',
    `create_by` BIGINT DEFAULT NULL COMMENT '创建者ID',
    `update_by` BIGINT DEFAULT NULL COMMENT '更新者ID',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    PRIMARY KEY (`id`),
    INDEX `idx_route_id` (`route_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='路线点位表';

DROP TABLE IF EXISTS `checkpoint`;
CREATE TABLE `checkpoint` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    `route_id` BIGINT NOT NULL COMMENT '路线ID',
    `name` VARCHAR(64) NOT NULL COMMENT '签到点名称',
    `description` VARCHAR(256) DEFAULT NULL COMMENT '签到点描述',
    `latitude` DECIMAL(10,7) NOT NULL COMMENT '纬度',
    `longitude` DECIMAL(10,7) NOT NULL COMMENT '经度',
    `radius` INT NOT NULL DEFAULT 100 COMMENT '有效签到半径（米）',
    `sequence` INT NOT NULL DEFAULT 0 COMMENT '顺序号（1=集合点，最大=终点）',
    `checkpoint_type` TINYINT NOT NULL DEFAULT 2 COMMENT '类型：1集合点 2途中点 3终点',
    `is_required` TINYINT NOT NULL DEFAULT 1 COMMENT '是否必签：0否 1是',
    `expected_arrive_minutes` INT DEFAULT NULL COMMENT '预计到达时间（从出发算起，分钟）',
    `create_by` BIGINT DEFAULT NULL COMMENT '创建者ID',
    `update_by` BIGINT DEFAULT NULL COMMENT '更新者ID',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    PRIMARY KEY (`id`),
    INDEX `idx_route_id` (`route_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='签到点表';

要求同上，放在 com.hiking.module.route.entity 包下。

请生成：
1. Route.java
2. RoutePoint.java
3. Checkpoint.java
```

---

### 3.5 签到相关Entity

```
请根据以下SQL表结构，生成Entity实体类。

表结构：
DROP TABLE IF EXISTS `check_in_record`;
CREATE TABLE `check_in_record` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    `user_id` BIGINT NOT NULL COMMENT '用户ID',
    `activity_id` BIGINT NOT NULL COMMENT '活动ID',
    `checkpoint_id` BIGINT NOT NULL COMMENT '签到点ID',
    `check_in_time` DATETIME NOT NULL COMMENT '签到时间',
    `latitude` DECIMAL(10,7) NOT NULL COMMENT '签到时纬度',
    `longitude` DECIMAL(10,7) NOT NULL COMMENT '签到时经度',
    `distance_to_checkpoint` INT DEFAULT NULL COMMENT '距签到点距离（米）',
    `status` TINYINT NOT NULL DEFAULT 1 COMMENT '状态：1正常 2迟到 3补签',
    `remark` VARCHAR(256) DEFAULT NULL COMMENT '备注',
    `create_by` BIGINT DEFAULT NULL COMMENT '创建者ID',
    `update_by` BIGINT DEFAULT NULL COMMENT '更新者ID',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    PRIMARY KEY (`id`),
    UNIQUE INDEX `idx_user_activity_checkpoint` (`user_id`, `activity_id`, `checkpoint_id`),
    INDEX `idx_activity_id` (`activity_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='签到记录表';

DROP TABLE IF EXISTS `track_record`;
CREATE TABLE `track_record` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    `user_id` BIGINT NOT NULL COMMENT '用户ID',
    `activity_id` BIGINT NOT NULL COMMENT '活动ID',
    `latitude` DECIMAL(10,7) NOT NULL COMMENT '纬度',
    `longitude` DECIMAL(10,7) NOT NULL COMMENT '经度',
    `elevation` INT DEFAULT NULL COMMENT '海拔（米）',
    `accuracy` INT DEFAULT NULL COMMENT '定位精度（米）',
    `speed` DECIMAL(5,2) DEFAULT NULL COMMENT '移动速度（km/h）',
    `record_time` DATETIME NOT NULL COMMENT '记录时间',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    PRIMARY KEY (`id`),
    INDEX `idx_user_activity` (`user_id`, `activity_id`),
    INDEX `idx_record_time` (`record_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='轨迹记录表';

DROP TABLE IF EXISTS `alert_event`;
CREATE TABLE `alert_event` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    `activity_id` BIGINT NOT NULL COMMENT '活动ID',
    `user_id` BIGINT NOT NULL COMMENT '触发用户ID',
    `alert_type` TINYINT NOT NULL COMMENT '预警类型：1偏离路线 2严重偏离 3长时间静止 4超时未签到 5失联',
    `alert_level` TINYINT NOT NULL DEFAULT 1 COMMENT '预警级别：1警告 2严重',
    `latitude` DECIMAL(10,7) DEFAULT NULL COMMENT '触发时纬度',
    `longitude` DECIMAL(10,7) DEFAULT NULL COMMENT '触发时经度',
    `description` VARCHAR(256) DEFAULT NULL COMMENT '预警描述',
    `trigger_time` DATETIME NOT NULL COMMENT '触发时间',
    `handle_status` TINYINT NOT NULL DEFAULT 0 COMMENT '处理状态：0未处理 1处理中 2已处理 3已忽略',
    `handle_by` BIGINT DEFAULT NULL COMMENT '处理人ID',
    `handle_time` DATETIME DEFAULT NULL COMMENT '处理时间',
    `handle_remark` VARCHAR(256) DEFAULT NULL COMMENT '处理备注',
    `create_by` BIGINT DEFAULT NULL COMMENT '创建者ID',
    `update_by` BIGINT DEFAULT NULL COMMENT '更新者ID',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    PRIMARY KEY (`id`),
    INDEX `idx_activity_id` (`activity_id`),
    INDEX `idx_user_id` (`user_id`),
    INDEX `idx_handle_status` (`handle_status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='预警事件表';

要求同上，放在 com.hiking.module.checkin.entity 包下。

请生成：
1. CheckInRecord.java
2. TrackRecord.java
3. AlertEvent.java
```

---

### 3.6 评价和消息Entity

```
请根据以下SQL表结构，生成Entity实体类。

表结构：
DROP TABLE IF EXISTS `review`;
CREATE TABLE `review` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    `user_id` BIGINT NOT NULL COMMENT '用户ID',
    `activity_id` BIGINT NOT NULL COMMENT '活动ID',
    `overall_rating` TINYINT NOT NULL COMMENT '整体评分：1-5星',
    `route_rating` TINYINT DEFAULT NULL COMMENT '路线评分：1-5星',
    `organization_rating` TINYINT DEFAULT NULL COMMENT '组织评分：1-5星',
    `safety_rating` TINYINT DEFAULT NULL COMMENT '安全评分：1-5星',
    `content` VARCHAR(512) DEFAULT NULL COMMENT '评价内容',
    `images` VARCHAR(1024) DEFAULT NULL COMMENT '评价图片URL（多个逗号分隔）',
    `is_anonymous` TINYINT NOT NULL DEFAULT 0 COMMENT '是否匿名：0否 1是',
    `status` TINYINT NOT NULL DEFAULT 1 COMMENT '状态：0隐藏 1显示',
    `create_by` BIGINT DEFAULT NULL COMMENT '创建者ID',
    `update_by` BIGINT DEFAULT NULL COMMENT '更新者ID',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    PRIMARY KEY (`id`),
    UNIQUE INDEX `idx_user_activity` (`user_id`, `activity_id`),
    INDEX `idx_activity_id` (`activity_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='评价表';

DROP TABLE IF EXISTS `message`;
CREATE TABLE `message` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    `user_id` BIGINT NOT NULL COMMENT '接收用户ID',
    `title` VARCHAR(128) NOT NULL COMMENT '消息标题',
    `content` VARCHAR(512) NOT NULL COMMENT '消息内容',
    `message_type` TINYINT NOT NULL DEFAULT 1 COMMENT '消息类型：1系统通知 2报名通知 3活动通知 4预警通知',
    `related_id` BIGINT DEFAULT NULL COMMENT '关联业务ID（如活动ID）',
    `related_type` VARCHAR(32) DEFAULT NULL COMMENT '关联业务类型（如activity）',
    `is_read` TINYINT NOT NULL DEFAULT 0 COMMENT '是否已读：0否 1是',
    `read_time` DATETIME DEFAULT NULL COMMENT '阅读时间',
    `create_by` BIGINT DEFAULT NULL COMMENT '创建者ID',
    `update_by` BIGINT DEFAULT NULL COMMENT '更新者ID',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    PRIMARY KEY (`id`),
    INDEX `idx_user_id` (`user_id`),
    INDEX `idx_is_read` (`is_read`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='消息表';

请生成：
1. Review.java（放在review模块）
2. Message.java（放在message模块）
```

---

### 3.7 系统字典Entity

```
请根据以下SQL表结构，生成Entity实体类。

表结构：
DROP TABLE IF EXISTS `dict_type`;
CREATE TABLE `dict_type` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    `dict_name` VARCHAR(64) NOT NULL COMMENT '字典名称',
    `dict_code` VARCHAR(64) NOT NULL COMMENT '字典编码（唯一）',
    `description` VARCHAR(256) DEFAULT NULL COMMENT '描述',
    `status` TINYINT NOT NULL DEFAULT 1 COMMENT '状态：0禁用 1正常',
    `create_by` BIGINT DEFAULT NULL COMMENT '创建者ID',
    `update_by` BIGINT DEFAULT NULL COMMENT '更新者ID',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    PRIMARY KEY (`id`),
    UNIQUE INDEX `idx_dict_code` (`dict_code`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='字典类型表';

DROP TABLE IF EXISTS `dict_data`;
CREATE TABLE `dict_data` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
    `dict_type_id` BIGINT NOT NULL COMMENT '字典类型ID',
    `dict_code` VARCHAR(64) NOT NULL COMMENT '所属字典编码',
    `label` VARCHAR(64) NOT NULL COMMENT '显示标签',
    `value` VARCHAR(64) NOT NULL COMMENT '数据值',
    `sequence` INT NOT NULL DEFAULT 0 COMMENT '排序号',
    `is_default` TINYINT NOT NULL DEFAULT 0 COMMENT '是否默认：0否 1是',
    `status` TINYINT NOT NULL DEFAULT 1 COMMENT '状态：0禁用 1正常',
    `remark` VARCHAR(256) DEFAULT NULL COMMENT '备注',
    `create_by` BIGINT DEFAULT NULL COMMENT '创建者ID',
    `update_by` BIGINT DEFAULT NULL COMMENT '更新者ID',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    PRIMARY KEY (`id`),
    INDEX `idx_dict_code` (`dict_code`),
    UNIQUE INDEX `idx_dict_code_value` (`dict_code`, `value`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='字典数据表';

放在 com.hiking.module.system.entity 包下。

请生成：
1. DictType.java
2. DictData.java
```

---

## 阶段四：Mapper接口生成

### 4.1 生成所有Mapper接口

```
请为以下Entity生成对应的Mapper接口。

Entity列表：
- User, UserProfile（user模块）
- Activity, GatheringPlan（activity模块）
- Registration（registration模块）
- Route, RoutePoint, Checkpoint（route模块）
- CheckInRecord, TrackRecord, AlertEvent（checkin模块）
- Review（review模块）
- Message（message模块）
- DictType, DictData（system模块）

要求：
1. 继承 BaseMapper<Entity>
2. 使用 @Mapper 注解
3. 放在对应模块的 mapper 包下
4. 每个Mapper一个文件

请生成所有Mapper接口。
```

---

## 阶段五：用户模块开发

### 5.1 用户DTO/VO定义

```
请为用户模块定义DTO和VO。

功能需求（来自功能模块设计文档）：
1. 用户注册：用户名、密码、确认密码、手机号（可选）、邮箱（可选）
2. 用户登录：用户名、密码
3. 用户信息展示：ID、用户名、昵称、头像、角色、手机号、邮箱

请生成：
1. UserRegisterDTO.java（注册请求）
   - 添加@NotBlank等校验注解
   - 密码和确认密码一致性校验
2. UserLoginDTO.java（登录请求）
3. UserVO.java（用户信息响应）
4. LoginVO.java（登录响应，包含token和用户信息）
5. UserProfileDTO.java（档案更新请求）
6. UserProfileVO.java（档案信息响应）
```

---

### 5.2 用户Service实现

```
请实现用户模块的Service层。

功能需求（来自功能模块设计文档）：
1. 用户注册：
   - 校验用户名/手机号/邮箱唯一性
   - 密码BCrypt加密
   - 创建用户同时创建空的用户档案
   - 默认角色为普通用户(0)
2. 用户登录：
   - 验证用户名和密码
   - 生成JWT Token
   - 更新最后登录时间
3. 获取当前用户信息
4. 更新用户档案

请生成：
1. UserService.java（接口）
2. UserServiceImpl.java（实现类）
   - 使用@Transactional管理事务
   - 抛出BusinessException处理业务错误
```

---

### 5.3 用户Controller实现

```
请实现用户模块的Controller层。

接口规范（来自系统架构设计文档）：
- RESTful风格
- 统一使用Result<T>响应
- 认证接口路径：/api/auth
- 用户接口路径：/api/user

接口列表：
1. POST /api/auth/register - 用户注册
2. POST /api/auth/login - 用户登录
3. GET /api/user/info - 获取当前用户信息（需登录）
4. PUT /api/user/profile - 更新用户档案（需登录）
5. GET /api/user/profile - 获取用户档案（需登录）

请生成：
1. AuthController.java（认证相关）
2. UserController.java（用户信息相关）
   - 添加Swagger注解（@Tag, @Operation）
   - 使用@Valid校验参数
```

---

### 5.4 完善UserDetailsService

```
请完善Spring Security的UserDetailsService实现。

要求：
1. 根据用户名查询用户
2. 返回UserDetails，包含：
   - 用户ID（可通过自定义UserDetails实现）
   - 用户名
   - 密码（加密后的）
   - 角色/权限
3. 用户不存在抛出UsernameNotFoundException

请更新：
1. UserDetailsServiceImpl.java
2. 如需要，创建自定义的LoginUser实现UserDetails
```

---

## 阶段六：活动模块开发

### 6.1 活动DTO/VO定义

```
请为活动模块定义DTO和VO。

功能需求（来自功能模块设计文档）：
1. 活动列表查询：支持分页、难度筛选、地区筛选、时间筛选、关键词搜索
2. 活动详情展示：所有活动信息 + 组织者信息 + 路线信息
3. 发布活动：活动所有字段
4. 审核活动：活动ID、审核结果、驳回原因

请生成：
1. ActivityQuery.java（列表查询条件）
2. ActivityCreateDTO.java（发布活动）
3. ActivityUpdateDTO.java（更新活动）
4. ActivityAuditDTO.java（审核活动）
5. ActivityListVO.java（列表展示，精简字段）
6. ActivityDetailVO.java（详情展示，完整字段）
```

---

### 6.2 活动Service实现

```
请实现活动模块的Service层。

功能需求（来自功能模块设计文档）：
1. 活动列表（分页查询）：
   - 支持多条件筛选
   - 只返回已发布(status=2)的活动
   - 按活动日期排序
2. 活动详情：
   - 查询活动信息
   - 关联查询组织者信息
   - 关联查询路线信息
   - 增加浏览次数
3. 发布活动（组织者）：
   - 创建活动，状态为草稿(0)
4. 提交审核：
   - 状态改为待审核(1)
5. 审核活动（管理员）：
   - 通过：状态改为已发布(2)
   - 驳回：状态改为已驳回(6)，记录驳回原因

请生成：
1. ActivityService.java（接口）
2. ActivityServiceImpl.java（实现类）
```

---

### 6.3 活动Controller实现

```
请实现活动模块的Controller层。

接口列表：
1. GET /api/activities - 活动列表（公开）
2. GET /api/activities/{id} - 活动详情（公开）
3. POST /api/activities - 发布活动（需登录，组织者）
4. PUT /api/activities/{id} - 更新活动（需登录，组织者本人）
5. PUT /api/activities/{id}/submit - 提交审核（需登录，组织者本人）
6. PUT /api/activities/{id}/audit - 审核活动（需登录，管理员）
7. GET /api/user/activities - 我发布的活动（需登录）
8. GET /api/user/joined-activities - 我参与的活动（需登录）

请生成：
1. ActivityController.java
   - 公开接口不需要认证
   - 需要权限校验的接口添加注释说明
```

---

## 阶段七：报名模块开发

### 7.1 报名DTO/VO定义

```
请为报名模块定义DTO和VO。

功能需求（来自功能模块设计文档）：
1. 提交报名：活动ID、报名备注
2. 审核报名：报名ID、审核结果、拒绝原因
3. 报名列表展示：报名信息 + 用户信息

请生成：
1. RegistrationCreateDTO.java（提交报名）
2. RegistrationAuditDTO.java（审核报名）
3. RegistrationVO.java（报名信息，含用户简要信息）
4. RegistrationQuery.java（查询条件：活动ID、状态）
```

---

### 7.2 报名Service实现

```
请实现报名模块的Service层。

功能需求（来自功能模块设计文档）：
1. 提交报名：
   - 校验活动是否存在且状态为已发布
   - 校验报名截止时间
   - 校验是否已报名过（不可重复报名）
   - 校验活动容量（可报名/候补）
   - 创建报名记录
2. 审核报名（组织者）：
   - 通过：状态改为已通过(1)，增加活动当前人数
   - 拒绝：状态改为已拒绝(2)，记录拒绝原因
3. 取消报名（参与者）：
   - 状态改为已取消(4)
   - 如果原状态为已通过，减少活动当前人数
4. 报名列表：按活动ID查询报名记录

请生成：
1. RegistrationService.java（接口）
2. RegistrationServiceImpl.java（实现类）
```

---

### 7.3 报名Controller实现

```
请实现报名模块的Controller层。

接口列表：
1. POST /api/registrations - 提交报名（需登录）
2. PUT /api/registrations/{id}/audit - 审核报名（需登录，组织者）
3. PUT /api/registrations/{id}/cancel - 取消报名（需登录，本人）
4. GET /api/activities/{activityId}/registrations - 活动的报名列表（需登录，组织者/管理员）
5. GET /api/user/registrations - 我的报名列表（需登录）

请生成：
1. RegistrationController.java
```

---

## 阶段八：签到模块开发

### 8.1 签到DTO/VO定义

```
请为签到模块定义DTO和VO。

功能需求（来自功能模块设计文档）：
1. GPS签到：活动ID、签到点ID、用户经纬度
2. 轨迹上报：活动ID、经纬度、海拔、精度、速度
3. 签到状态展示：签到点列表 + 各点签到状态

请生成：
1. CheckInDTO.java（签到请求）
2. TrackReportDTO.java（轨迹上报）
3. CheckInRecordVO.java（签到记录）
4. CheckInStatusVO.java（签到状态，含签到点列表和进度）
5. CheckpointVO.java（签到点信息）
```

---

### 8.2 签到Service实现

```
请实现签到模块的Service层。

功能需求（来自功能模块设计文档-签到技术说明）：
1. GPS签到：
   - 校验用户是否已报名且审核通过
   - 校验活动是否在进行中
   - 获取签到点坐标和有效半径
   - 使用GeoUtils计算用户位置与签到点的距离
   - 判断距离是否在有效半径内
   - 记录签到（时间、坐标、距离）
   - 防止重复签到
2. 轨迹上报：
   - 批量插入轨迹记录
3. 获取签到状态：
   - 查询活动的所有签到点
   - 查询用户在各签到点的签到记录
   - 返回签到进度

请生成：
1. CheckInService.java（接口）
2. CheckInServiceImpl.java（实现类）
```

---

### 8.3 签到Controller实现

```
请实现签到模块的Controller层。

接口列表：
1. POST /api/checkin - GPS签到（需登录）
2. GET /api/activities/{activityId}/checkin-status - 我的签到状态（需登录）
3. GET /api/activities/{activityId}/checkpoints - 签到点列表（需登录）
4. POST /api/track/report - 轨迹上报（需登录）
5. GET /api/activities/{activityId}/participants-status - 所有参与者签到状态（组织者）

请生成：
1. CheckInController.java
```

---

## 阶段九：其他模块开发

### 9.1 集合方案模块

```
请实现集合方案功能。

功能需求：
1. 创建/更新集合方案（组织者）
2. 发布集合方案（向参与者发送通知）
3. 获取集合方案（参与者查看）

请生成：
1. GatheringPlanDTO.java
2. GatheringPlanVO.java
3. GatheringPlanService.java + Impl
4. GatheringPlanController.java

接口：
- POST /api/activities/{activityId}/gathering-plan
- PUT /api/activities/{activityId}/gathering-plan
- PUT /api/activities/{activityId}/gathering-plan/publish
- GET /api/activities/{activityId}/gathering-plan
```

---

### 9.2 评价模块

```
请实现评价模块。

功能需求：
1. 提交评价（仅已完成活动的参与者）
2. 获取活动评价列表
3. 每人每活动仅可评价一次

请生成相关DTO、VO、Service、Controller。

接口：
- POST /api/activities/{activityId}/reviews
- GET /api/activities/{activityId}/reviews
```

---

### 9.3 消息模块

```
请实现消息模块。

功能需求：
1. 获取我的消息列表（分页）
2. 标记消息已读
3. 批量标记已读
4. 获取未读消息数量

请生成相关DTO、VO、Service、Controller。

接口：
- GET /api/user/messages
- PUT /api/messages/{id}/read
- PUT /api/messages/read-all
- GET /api/user/messages/unread-count
```

---

### 9.4 路线模块

```
请实现路线模块。

功能需求：
1. 创建路线（组织者）
2. 路线列表（公开路线）
3. 路线详情（含点位信息）
4. 为路线添加签到点

请生成相关DTO、VO、Service、Controller。

接口：
- POST /api/routes
- GET /api/routes
- GET /api/routes/{id}
- POST /api/routes/{id}/checkpoints
```

---

### 9.5 字典模块

```
请实现字典模块。

功能需求：
1. 获取字典类型列表（管理员）
2. 获取字典数据（根据字典编码）
3. 前端下拉选项获取

请生成相关Service、Controller。

接口：
- GET /api/dict/types（管理员）
- GET /api/dict/data/{dictCode}（公开，用于前端下拉）
```

---

## 阶段十：管理员功能

### 10.1 管理后台接口

```
请实现管理后台相关接口。

功能需求：
1. 数据统计概览：用户数、活动数、今日报名数、待审核数
2. 用户管理：用户列表、禁用/启用用户
3. 预警事件：预警列表、处理预警

请生成相关Service、Controller。

接口：
- GET /api/admin/dashboard（统计数据）
- GET /api/admin/users（用户列表）
- PUT /api/admin/users/{id}/status（禁用/启用）
- GET /api/admin/alerts（预警列表）
- PUT /api/admin/alerts/{id}/handle（处理预警）

注意：所有管理接口需要管理员权限。
```

---

## 附录：常用问题处理

### A1. 代码报错修复

```
运行时遇到以下错误，请帮我修复：

错误信息：
[粘贴完整的错误堆栈]

相关代码：
[粘贴相关代码]
```

---

### A2. 功能优化

```
请优化以下功能：

当前实现：
[描述当前实现方式]

问题：
[描述遇到的问题]

期望效果：
[描述期望的效果]
```

---

### A3. 新增字段

```
需要在[表名]表中新增字段：
- 字段名：xxx
- 类型：xxx
- 说明：xxx

请更新：
1. Entity实体类
2. 相关的DTO/VO（如需要）
3. 相关的Service逻辑（如需要）
```

---

### A4. 依赖冲突排查与解决

```
项目启动时遇到依赖冲突错误：

错误信息：
[粘贴完整的错误信息]

请帮我：
1. 分析是哪个依赖版本冲突
2. 提供解决方案
3. 如需修改pom.xml，请给出具体修改内容
```

---

### A5. 查看依赖树

```
如果遇到依赖冲突，可以使用以下命令查看依赖树：

# 查看完整依赖树
mvn dependency:tree

# 查看特定依赖的冲突
mvn dependency:tree -Dincludes=groupId:artifactId

# 分析依赖冲突
mvn dependency:analyze
```

---

## 附录B：版本兼容速查表

### B1. 本项目使用的版本组合（已验证兼容）

| 依赖 | 版本 | Maven依赖 |
|------|------|-----------|
| SpringBoot | 3.2.0 | spring-boot-starter-parent |
| JDK | 17 | - |
| MyBatis-Plus | 3.5.5 | mybatis-plus-spring-boot3-starter |
| MySQL Connector | 8.0.33 | mysql-connector-j（由SpringBoot管理） |
| JWT (jjwt) | 0.12.3 | jjwt-api, jjwt-impl, jjwt-jackson |
| Lombok | 由SpringBoot管理 | lombok |
| SpringDoc | 2.3.0 | springdoc-openapi-starter-webmvc-ui |
| Knife4j | 4.3.0 | knife4j-openapi3-jakarta-spring-boot-starter |
| Hutool | 5.8.24 | hutool-all（可选工具库） |

### B2. 常见依赖冲突及解决方案

| 问题 | 原因 | 解决方案 |
|------|------|----------|
| jakarta.* 找不到 | SpringBoot 3.x使用jakarta命名空间 | 确保使用SpringBoot 3.x兼容的依赖 |
| MyBatis-Plus启动失败 | 使用了非boot3版本 | 改用mybatis-plus-spring-boot3-starter |
| Swagger页面404 | SpringDoc版本不对 | SpringBoot 3.x用springdoc 2.x |
| JWT解析失败 | jjwt版本API变化 | 0.12.x版本API与0.11.x不同 |

### B3. pom.xml模板（依赖部分）

```xml
<properties>
    <java.version>17</java.version>
    <mybatis-plus.version>3.5.5</mybatis-plus.version>
    <jjwt.version>0.12.3</jjwt.version>
    <springdoc.version>2.3.0</springdoc.version>
    <knife4j.version>4.3.0</knife4j.version>
</properties>

<dependencies>
    <!-- SpringBoot Starters（版本由parent管理）-->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-security</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-validation</artifactId>
    </dependency>
    
    <!-- MyBatis-Plus（注意是boot3版本）-->
    <dependency>
        <groupId>com.baomidou</groupId>
        <artifactId>mybatis-plus-spring-boot3-starter</artifactId>
        <version>${mybatis-plus.version}</version>
    </dependency>
    
    <!-- MySQL -->
    <dependency>
        <groupId>com.mysql</groupId>
        <artifactId>mysql-connector-j</artifactId>
        <scope>runtime</scope>
    </dependency>
    
    <!-- JWT -->
    <dependency>
        <groupId>io.jsonwebtoken</groupId>
        <artifactId>jjwt-api</artifactId>
        <version>${jjwt.version}</version>
    </dependency>
    <dependency>
        <groupId>io.jsonwebtoken</groupId>
        <artifactId>jjwt-impl</artifactId>
        <version>${jjwt.version}</version>
        <scope>runtime</scope>
    </dependency>
    <dependency>
        <groupId>io.jsonwebtoken</groupId>
        <artifactId>jjwt-jackson</artifactId>
        <version>${jjwt.version}</version>
        <scope>runtime</scope>
    </dependency>
    
    <!-- SpringDoc + Knife4j -->
    <dependency>
        <groupId>org.springdoc</groupId>
        <artifactId>springdoc-openapi-starter-webmvc-ui</artifactId>
        <version>${springdoc.version}</version>
    </dependency>
    <dependency>
        <groupId>com.github.xiaoymin</groupId>
        <artifactId>knife4j-openapi3-jakarta-spring-boot-starter</artifactId>
        <version>${knife4j.version}</version>
    </dependency>
    
    <!-- Lombok -->
    <dependency>
        <groupId>org.projectlombok</groupId>
        <artifactId>lombok</artifactId>
        <optional>true</optional>
    </dependency>
</dependencies>
```

---

## 文档版本

| 版本 | 日期 | 修改内容 |
|------|------|----------|
| v1.0 | 2024-12-23 | 初稿 |

