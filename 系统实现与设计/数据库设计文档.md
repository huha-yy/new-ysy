# 户外徒步活动管理系统 - 数据库设计文档

## 一、设计规范

### 1.1 命名规范
- 表名、字段名：小写字母，单词间用下划线分隔
- 主键：统一使用 `id`，BIGINT 自增
- 外键字段：`关联表名_id`，如 `user_id`、`activity_id`

### 1.2 公共字段
所有业务表包含以下4个公共字段：

| 字段名 | 类型 | 说明 |
|--------|------|------|
| create_by | BIGINT | 创建者ID |
| update_by | BIGINT | 更新者ID |
| create_time | DATETIME | 创建时间 |
| update_time | DATETIME | 更新时间 |

### 1.3 字段长度规范
VARCHAR 长度取 2^n：16, 32, 64, 128, 256, 512

### 1.4 索引规范
- 不使用物理外键约束
- 只建立必要的唯一索引
- 普通索引后期根据查询优化

### 1.5 字符集
- 字符集：utf8mb4
- 排序规则：utf8mb4_general_ci

---

## 二、表清单

| 序号 | 表名 | 中文名 | 所属模块 |
|------|------|--------|----------|
| 1 | user | 用户表 | 用户管理 |
| 2 | user_profile | 用户档案表 | 用户管理 |
| 3 | activity | 活动表 | 活动管理 |
| 4 | registration | 报名表 | 报名管理 |
| 5 | gathering_plan | 集合方案表 | 集合管理 |
| 6 | route | 路线表 | 路线管理 |
| 7 | route_point | 路线点位表 | 路线管理 |
| 8 | checkpoint | 签到点表 | 签到管理 |
| 9 | check_in_record | 签到记录表 | 签到管理 |
| 10 | track_record | 轨迹记录表 | 签到管理 |
| 11 | alert_event | 预警事件表 | 签到管理 |
| 12 | review | 评价表 | 评价反馈 |
| 13 | message | 消息表 | 消息通知 |
| 14 | dict_type | 字典类型表 | 系统基础 |
| 15 | dict_data | 字典数据表 | 系统基础 |

---

## 三、表结构详细设计

### 3.1 user（用户表）

> 存储用户账号、密码、角色等登录相关信息

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | NO | AUTO_INCREMENT | 主键ID |
| username | VARCHAR(32) | NO | - | 用户名（唯一） |
| password | VARCHAR(64) | NO | - | 密码（BCrypt加密） |
| phone | VARCHAR(16) | YES | NULL | 手机号（唯一） |
| email | VARCHAR(64) | YES | NULL | 邮箱（唯一） |
| nickname | VARCHAR(32) | YES | NULL | 昵称 |
| avatar | VARCHAR(256) | YES | NULL | 头像URL |
| role | TINYINT | NO | 0 | 角色：0普通用户 1组织者 2管理员 |
| status | TINYINT | NO | 1 | 状态：0禁用 1正常 |
| last_login_time | DATETIME | YES | NULL | 最后登录时间 |
| create_by | BIGINT | YES | NULL | 创建者ID |
| update_by | BIGINT | YES | NULL | 更新者ID |
| create_time | DATETIME | NO | CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |

**索引：**
- `UNIQUE INDEX idx_username (username)`
- `UNIQUE INDEX idx_phone (phone)`
- `UNIQUE INDEX idx_email (email)`

---

### 3.2 user_profile（用户档案表）

> 存储用户徒步档案、健康状况、紧急联系人、偏好设置等

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | NO | AUTO_INCREMENT | 主键ID |
| user_id | BIGINT | NO | - | 用户ID（唯一） |
| real_name | VARCHAR(32) | YES | NULL | 真实姓名 |
| gender | TINYINT | YES | NULL | 性别：0未知 1男 2女 |
| birth_date | DATE | YES | NULL | 出生日期 |
| experience_level | TINYINT | NO | 0 | 徒步经验：0新手 1初级 2中级 3高级 4专业 |
| health_status | VARCHAR(256) | YES | NULL | 健康状况描述 |
| medical_history | VARCHAR(512) | YES | NULL | 病史/过敏史 |
| emergency_contact | VARCHAR(32) | YES | NULL | 紧急联系人姓名 |
| emergency_phone | VARCHAR(16) | YES | NULL | 紧急联系人电话 |
| equipment_list | VARCHAR(512) | YES | NULL | 常用装备清单 |
| preference_intensity | TINYINT | YES | NULL | 偏好强度：1低 2中 3高 |
| preference_distance | TINYINT | YES | NULL | 偏好里程：1短(<10km) 2中(10-20km) 3长(>20km) |
| preference_region | VARCHAR(128) | YES | NULL | 偏好地区（多个逗号分隔） |
| bio | VARCHAR(256) | YES | NULL | 个人简介 |
| create_by | BIGINT | YES | NULL | 创建者ID |
| update_by | BIGINT | YES | NULL | 更新者ID |
| create_time | DATETIME | NO | CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |

**索引：**
- `UNIQUE INDEX idx_user_id (user_id)`

---

### 3.3 activity（活动表）

> 存储徒步活动的基本信息、时间、状态等

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | NO | AUTO_INCREMENT | 主键ID |
| title | VARCHAR(128) | NO | - | 活动标题 |
| cover_image | VARCHAR(256) | YES | NULL | 封面图片URL |
| description | TEXT | YES | NULL | 活动详细描述 |
| organizer_id | BIGINT | NO | - | 组织者用户ID |
| route_id | BIGINT | YES | NULL | 关联路线ID |
| activity_date | DATE | NO | - | 活动日期 |
| start_time | TIME | NO | - | 开始时间 |
| end_time | TIME | YES | NULL | 预计结束时间 |
| duration_hours | DECIMAL(4,1) | YES | NULL | 预计时长（小时） |
| max_participants | INT | NO | 20 | 人数上限 |
| current_participants | INT | NO | 0 | 当前报名人数 |
| registration_deadline | DATETIME | NO | - | 报名截止时间 |
| difficulty_level | TINYINT | NO | 1 | 难度：1休闲 2简单 3中等 4困难 5极限 |
| fee | DECIMAL(10,2) | YES | 0.00 | 费用（元） |
| fee_description | VARCHAR(256) | YES | NULL | 费用说明 |
| equipment_requirement | VARCHAR(512) | YES | NULL | 装备要求 |
| fitness_requirement | VARCHAR(256) | YES | NULL | 体能要求 |
| age_min | INT | YES | NULL | 最小年龄限制 |
| age_max | INT | YES | NULL | 最大年龄限制 |
| experience_requirement | TINYINT | YES | NULL | 经验要求：0不限 1初级以上 2中级以上 3高级以上 |
| status | TINYINT | NO | 0 | 状态：0草稿 1待审核 2已发布 3进行中 4已结束 5已取消 6已驳回 |
| reject_reason | VARCHAR(256) | YES | NULL | 驳回原因 |
| audit_by | BIGINT | YES | NULL | 审核人ID |
| audit_time | DATETIME | YES | NULL | 审核时间 |
| view_count | INT | NO | 0 | 浏览次数 |
| create_by | BIGINT | YES | NULL | 创建者ID |
| update_by | BIGINT | YES | NULL | 更新者ID |
| create_time | DATETIME | NO | CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |

**索引：**
- `INDEX idx_organizer_id (organizer_id)`
- `INDEX idx_status (status)`
- `INDEX idx_activity_date (activity_date)`

---

### 3.4 registration（报名表）

> 存储用户报名活动的记录

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | NO | AUTO_INCREMENT | 主键ID |
| user_id | BIGINT | NO | - | 用户ID |
| activity_id | BIGINT | NO | - | 活动ID |
| status | TINYINT | NO | 0 | 状态：0待审核 1已通过 2已拒绝 3候补中 4已取消 5已缺席 |
| reject_reason | VARCHAR(256) | YES | NULL | 拒绝原因 |
| queue_number | INT | YES | NULL | 候补序号 |
| remark | VARCHAR(256) | YES | NULL | 报名备注 |
| audit_by | BIGINT | YES | NULL | 审核人ID |
| audit_time | DATETIME | YES | NULL | 审核时间 |
| cancel_time | DATETIME | YES | NULL | 取消时间 |
| cancel_reason | VARCHAR(256) | YES | NULL | 取消原因 |
| create_by | BIGINT | YES | NULL | 创建者ID |
| update_by | BIGINT | YES | NULL | 更新者ID |
| create_time | DATETIME | NO | CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |

**索引：**
- `UNIQUE INDEX idx_user_activity (user_id, activity_id)`
- `INDEX idx_activity_id (activity_id)`
- `INDEX idx_status (status)`

---

### 3.5 gathering_plan（集合方案表）

> 存储活动的集合方案信息

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | NO | AUTO_INCREMENT | 主键ID |
| activity_id | BIGINT | NO | - | 活动ID（唯一） |
| gathering_time | DATETIME | NO | - | 集合时间 |
| gathering_address | VARCHAR(256) | NO | - | 集合地点详细地址 |
| gathering_latitude | DECIMAL(10,7) | YES | NULL | 集合点纬度 |
| gathering_longitude | DECIMAL(10,7) | YES | NULL | 集合点经度 |
| transport_guide | VARCHAR(512) | YES | NULL | 交通指引 |
| items_to_bring | VARCHAR(512) | YES | NULL | 携带物品清单 |
| notice | TEXT | YES | NULL | 注意事项 |
| organizer_phone | VARCHAR(16) | YES | NULL | 组织者联系电话 |
| is_published | TINYINT | NO | 0 | 是否已发布：0否 1是 |
| publish_time | DATETIME | YES | NULL | 发布时间 |
| create_by | BIGINT | YES | NULL | 创建者ID |
| update_by | BIGINT | YES | NULL | 更新者ID |
| create_time | DATETIME | NO | CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |

**索引：**
- `UNIQUE INDEX idx_activity_id (activity_id)`

---

### 3.6 route（路线表）

> 存储徒步路线的基本信息

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | NO | AUTO_INCREMENT | 主键ID |
| name | VARCHAR(128) | NO | - | 路线名称 |
| description | TEXT | YES | NULL | 路线描述 |
| creator_id | BIGINT | NO | - | 创建者用户ID |
| difficulty_level | TINYINT | NO | 1 | 难度：1休闲 2简单 3中等 4困难 5极限 |
| total_distance | DECIMAL(6,2) | YES | NULL | 总里程（公里） |
| elevation_gain | INT | YES | NULL | 累计爬升（米） |
| elevation_loss | INT | YES | NULL | 累计下降（米） |
| max_elevation | INT | YES | NULL | 最高海拔（米） |
| min_elevation | INT | YES | NULL | 最低海拔（米） |
| estimated_hours | DECIMAL(4,1) | YES | NULL | 预计用时（小时） |
| start_point_name | VARCHAR(64) | YES | NULL | 起点名称 |
| start_latitude | DECIMAL(10,7) | YES | NULL | 起点纬度 |
| start_longitude | DECIMAL(10,7) | YES | NULL | 起点经度 |
| end_point_name | VARCHAR(64) | YES | NULL | 终点名称 |
| end_latitude | DECIMAL(10,7) | YES | NULL | 终点纬度 |
| end_longitude | DECIMAL(10,7) | YES | NULL | 终点经度 |
| region | VARCHAR(64) | YES | NULL | 所属地区 |
| is_public | TINYINT | NO | 1 | 是否公开：0否 1是 |
| use_count | INT | NO | 0 | 被使用次数 |
| status | TINYINT | NO | 1 | 状态：0禁用 1正常 |
| create_by | BIGINT | YES | NULL | 创建者ID |
| update_by | BIGINT | YES | NULL | 更新者ID |
| create_time | DATETIME | NO | CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |

**索引：**
- `INDEX idx_creator_id (creator_id)`
- `INDEX idx_difficulty_level (difficulty_level)`

---

### 3.7 route_point（路线点位表）

> 存储路线上的途经点、风险点等（非签到点）

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | NO | AUTO_INCREMENT | 主键ID |
| route_id | BIGINT | NO | - | 路线ID |
| point_type | TINYINT | NO | 1 | 点位类型：1途经点 2风险点 3休息点 4补给点 |
| name | VARCHAR(64) | NO | - | 点位名称 |
| description | VARCHAR(256) | YES | NULL | 点位描述 |
| latitude | DECIMAL(10,7) | NO | - | 纬度 |
| longitude | DECIMAL(10,7) | NO | - | 经度 |
| elevation | INT | YES | NULL | 海拔（米） |
| sequence | INT | NO | 0 | 顺序号 |
| risk_level | TINYINT | YES | NULL | 风险等级：1低 2中 3高（仅风险点） |
| risk_tip | VARCHAR(256) | YES | NULL | 风险提示（仅风险点） |
| create_by | BIGINT | YES | NULL | 创建者ID |
| update_by | BIGINT | YES | NULL | 更新者ID |
| create_time | DATETIME | NO | CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |

**索引：**
- `INDEX idx_route_id (route_id)`

---

### 3.8 checkpoint（签到点表）

> 存储路线上的签到点信息

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | NO | AUTO_INCREMENT | 主键ID |
| route_id | BIGINT | NO | - | 路线ID |
| name | VARCHAR(64) | NO | - | 签到点名称 |
| description | VARCHAR(256) | YES | NULL | 签到点描述 |
| latitude | DECIMAL(10,7) | NO | - | 纬度 |
| longitude | DECIMAL(10,7) | NO | - | 经度 |
| radius | INT | NO | 100 | 有效签到半径（米） |
| sequence | INT | NO | 0 | 顺序号（1=集合点，最大=终点） |
| checkpoint_type | TINYINT | NO | 2 | 类型：1集合点 2途中点 3终点 |
| is_required | TINYINT | NO | 1 | 是否必签：0否 1是 |
| expected_arrive_minutes | INT | YES | NULL | 预计到达时间（从出发算起，分钟） |
| create_by | BIGINT | YES | NULL | 创建者ID |
| update_by | BIGINT | YES | NULL | 更新者ID |
| create_time | DATETIME | NO | CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |

**索引：**
- `INDEX idx_route_id (route_id)`

---

### 3.9 check_in_record（签到记录表）

> 存储用户在各签到点的签到记录

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | NO | AUTO_INCREMENT | 主键ID |
| user_id | BIGINT | NO | - | 用户ID |
| activity_id | BIGINT | NO | - | 活动ID |
| checkpoint_id | BIGINT | NO | - | 签到点ID |
| check_in_time | DATETIME | NO | - | 签到时间 |
| latitude | DECIMAL(10,7) | NO | - | 签到时纬度 |
| longitude | DECIMAL(10,7) | NO | - | 签到时经度 |
| distance_to_checkpoint | INT | YES | NULL | 距签到点距离（米） |
| status | TINYINT | NO | 1 | 状态：1正常 2迟到 3补签 |
| remark | VARCHAR(256) | YES | NULL | 备注 |
| create_by | BIGINT | YES | NULL | 创建者ID |
| update_by | BIGINT | YES | NULL | 更新者ID |
| create_time | DATETIME | NO | CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |

**索引：**
- `UNIQUE INDEX idx_user_activity_checkpoint (user_id, activity_id, checkpoint_id)`
- `INDEX idx_activity_id (activity_id)`

---

### 3.10 track_record（轨迹记录表）

> 存储用户GPS位置上报记录，用于轨迹回放和监控

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | NO | AUTO_INCREMENT | 主键ID |
| user_id | BIGINT | NO | - | 用户ID |
| activity_id | BIGINT | NO | - | 活动ID |
| latitude | DECIMAL(10,7) | NO | - | 纬度 |
| longitude | DECIMAL(10,7) | NO | - | 经度 |
| elevation | INT | YES | NULL | 海拔（米） |
| accuracy | INT | YES | NULL | 定位精度（米） |
| speed | DECIMAL(5,2) | YES | NULL | 移动速度（km/h） |
| record_time | DATETIME | NO | - | 记录时间 |
| create_time | DATETIME | NO | CURRENT_TIMESTAMP | 创建时间 |

**索引：**
- `INDEX idx_user_activity (user_id, activity_id)`
- `INDEX idx_record_time (record_time)`

> 注意：此表数据量大，不设置 update 相关字段，只做插入不做更新

---

### 3.11 alert_event（预警事件表）

> 存储偏离路线、长时间静止等异常预警事件

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | NO | AUTO_INCREMENT | 主键ID |
| activity_id | BIGINT | NO | - | 活动ID |
| user_id | BIGINT | NO | - | 触发用户ID |
| alert_type | TINYINT | NO | - | 预警类型：1偏离路线 2严重偏离 3长时间静止 4超时未签到 5失联 |
| alert_level | TINYINT | NO | 1 | 预警级别：1警告 2严重 |
| latitude | DECIMAL(10,7) | YES | NULL | 触发时纬度 |
| longitude | DECIMAL(10,7) | YES | NULL | 触发时经度 |
| description | VARCHAR(256) | YES | NULL | 预警描述 |
| trigger_time | DATETIME | NO | - | 触发时间 |
| handle_status | TINYINT | NO | 0 | 处理状态：0未处理 1处理中 2已处理 3已忽略 |
| handle_by | BIGINT | YES | NULL | 处理人ID |
| handle_time | DATETIME | YES | NULL | 处理时间 |
| handle_remark | VARCHAR(256) | YES | NULL | 处理备注 |
| create_by | BIGINT | YES | NULL | 创建者ID |
| update_by | BIGINT | YES | NULL | 更新者ID |
| create_time | DATETIME | NO | CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |

**索引：**
- `INDEX idx_activity_id (activity_id)`
- `INDEX idx_user_id (user_id)`
- `INDEX idx_handle_status (handle_status)`

---

### 3.12 review（评价表）

> 存储用户对活动的评分和评论

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | NO | AUTO_INCREMENT | 主键ID |
| user_id | BIGINT | NO | - | 用户ID |
| activity_id | BIGINT | NO | - | 活动ID |
| overall_rating | TINYINT | NO | - | 整体评分：1-5星 |
| route_rating | TINYINT | YES | NULL | 路线评分：1-5星 |
| organization_rating | TINYINT | YES | NULL | 组织评分：1-5星 |
| safety_rating | TINYINT | YES | NULL | 安全评分：1-5星 |
| content | VARCHAR(512) | YES | NULL | 评价内容 |
| images | VARCHAR(1024) | YES | NULL | 评价图片URL（多个逗号分隔） |
| is_anonymous | TINYINT | NO | 0 | 是否匿名：0否 1是 |
| status | TINYINT | NO | 1 | 状态：0隐藏 1显示 |
| create_by | BIGINT | YES | NULL | 创建者ID |
| update_by | BIGINT | YES | NULL | 更新者ID |
| create_time | DATETIME | NO | CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |

**索引：**
- `UNIQUE INDEX idx_user_activity (user_id, activity_id)`
- `INDEX idx_activity_id (activity_id)`

---

### 3.13 message（消息表）

> 存储站内通知消息

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | NO | AUTO_INCREMENT | 主键ID |
| user_id | BIGINT | NO | - | 接收用户ID |
| title | VARCHAR(128) | NO | - | 消息标题 |
| content | VARCHAR(512) | NO | - | 消息内容 |
| message_type | TINYINT | NO | 1 | 消息类型：1系统通知 2报名通知 3活动通知 4预警通知 |
| related_id | BIGINT | YES | NULL | 关联业务ID（如活动ID） |
| related_type | VARCHAR(32) | YES | NULL | 关联业务类型（如activity） |
| is_read | TINYINT | NO | 0 | 是否已读：0否 1是 |
| read_time | DATETIME | YES | NULL | 阅读时间 |
| create_by | BIGINT | YES | NULL | 创建者ID |
| update_by | BIGINT | YES | NULL | 更新者ID |
| create_time | DATETIME | NO | CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |

**索引：**
- `INDEX idx_user_id (user_id)`
- `INDEX idx_is_read (is_read)`

---

### 3.14 dict_type（字典类型表）

> 存储字典分类

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | NO | AUTO_INCREMENT | 主键ID |
| dict_name | VARCHAR(64) | NO | - | 字典名称 |
| dict_code | VARCHAR(64) | NO | - | 字典编码（唯一） |
| description | VARCHAR(256) | YES | NULL | 描述 |
| status | TINYINT | NO | 1 | 状态：0禁用 1正常 |
| create_by | BIGINT | YES | NULL | 创建者ID |
| update_by | BIGINT | YES | NULL | 更新者ID |
| create_time | DATETIME | NO | CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |

**索引：**
- `UNIQUE INDEX idx_dict_code (dict_code)`

---

### 3.15 dict_data（字典数据表）

> 存储字典具体值

| 字段名 | 类型 | 可空 | 默认值 | 说明 |
|--------|------|------|--------|------|
| id | BIGINT | NO | AUTO_INCREMENT | 主键ID |
| dict_type_id | BIGINT | NO | - | 字典类型ID |
| dict_code | VARCHAR(64) | NO | - | 所属字典编码 |
| label | VARCHAR(64) | NO | - | 显示标签 |
| value | VARCHAR(64) | NO | - | 数据值 |
| sequence | INT | NO | 0 | 排序号 |
| is_default | TINYINT | NO | 0 | 是否默认：0否 1是 |
| status | TINYINT | NO | 1 | 状态：0禁用 1正常 |
| remark | VARCHAR(256) | YES | NULL | 备注 |
| create_by | BIGINT | YES | NULL | 创建者ID |
| update_by | BIGINT | YES | NULL | 更新者ID |
| create_time | DATETIME | NO | CURRENT_TIMESTAMP | 创建时间 |
| update_time | DATETIME | NO | CURRENT_TIMESTAMP ON UPDATE | 更新时间 |

**索引：**
- `INDEX idx_dict_code (dict_code)`
- `UNIQUE INDEX idx_dict_code_value (dict_code, value)`

---

## 四、表关系ER图

```
                                    ┌─────────────────┐
                                    │    dict_type    │
                                    │   (字典类型表)   │
                                    └────────┬────────┘
                                             │ 1:N
                                             ▼
                                    ┌─────────────────┐
                                    │    dict_data    │
                                    │   (字典数据表)   │
                                    └─────────────────┘


┌──────────┐  1:1   ┌───────────────┐
│   user   │───────▶│  user_profile │
│ (用户表)  │        │  (用户档案表)  │
└────┬─────┘        └───────────────┘
     │
     │ 1:N
     ▼
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  ┌──────────────┐   N:1   ┌─────────┐   1:N   ┌─────────────────┐  │
│  │   activity   │────────▶│  route  │────────▶│   route_point   │  │
│  │   (活动表)    │         │ (路线表) │         │  (路线点位表)    │  │
│  └──────┬───────┘         └────┬────┘         └─────────────────┘  │
│         │                      │                                    │
│         │ 1:1                  │ 1:N                                │
│         ▼                      ▼                                    │
│  ┌────────────────┐    ┌─────────────┐                             │
│  │ gathering_plan │    │ checkpoint  │                             │
│  │  (集合方案表)   │    │  (签到点表)  │                             │
│  └────────────────┘    └──────┬──────┘                             │
│                               │                                     │
└───────────────────────────────┼─────────────────────────────────────┘
                                │
     ┌──────────────────────────┼──────────────────────────┐
     │                          │                          │
     ▼                          ▼                          ▼
┌───────────────┐    ┌─────────────────┐    ┌─────────────────┐
│  registration │    │ check_in_record │    │  track_record   │
│   (报名表)     │    │   (签到记录表)   │    │   (轨迹记录表)   │
└───────────────┘    └─────────────────┘    └─────────────────┘
     │
     ▼
┌───────────────┐    ┌───────────────┐    ┌───────────────┐
│    review     │    │  alert_event  │    │    message    │
│   (评价表)     │    │  (预警事件表)  │    │   (消息表)     │
└───────────────┘    └───────────────┘    └───────────────┘
```

---

## 五、字典数据初始化

### 5.1 字典类型

| dict_code | dict_name |
|-----------|-----------|
| user_role | 用户角色 |
| user_status | 用户状态 |
| gender | 性别 |
| experience_level | 徒步经验等级 |
| activity_status | 活动状态 |
| difficulty_level | 难度等级 |
| registration_status | 报名状态 |
| checkpoint_type | 签到点类型 |
| check_in_status | 签到状态 |
| alert_type | 预警类型 |
| alert_level | 预警级别 |
| handle_status | 处理状态 |
| message_type | 消息类型 |

### 5.2 字典数据示例

**activity_status（活动状态）：**
| label | value |
|-------|-------|
| 草稿 | 0 |
| 待审核 | 1 |
| 已发布 | 2 |
| 进行中 | 3 |
| 已结束 | 4 |
| 已取消 | 5 |
| 已驳回 | 6 |

**difficulty_level（难度等级）：**
| label | value |
|-------|-------|
| 休闲 | 1 |
| 简单 | 2 |
| 中等 | 3 |
| 困难 | 4 |
| 极限 | 5 |

---

## 六、文档版本

| 版本 | 日期 | 修改内容 | 作者 |
|------|------|----------|------|
| v1.0 | 2024-12-23 | 初稿，完成15张表结构设计 | - |

